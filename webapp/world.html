<!DOCTYPE html>

<html lang="en" data-ng-app="worldModule">
<head>
	<title>Shelter</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/bootstrap-theme.css">
	<link rel="stylesheet" href="https://cdn.datatables.net/1.10.9/css/jquery.dataTables.min.css">
</head>

<body role="document" >
	<nav id="navbar" class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div id="navbar" class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li class="active"><a href="shelter.html">Shelter view</a></li>
					<li><a href="world.html">World map</a></li>
				</ul>
			</div>
		</div>
	</nav>
	
	<div class="container" role="main">
		<div data-ng-controller="worldController" class="row">
		    <div class="col-xs-12 col-sm-12 col-md-12">
				<h3>
					World view
					<span class="pull-right">
			    		<button class="btn btn-xs btn-primary" data-ng-click="updateWorld()">
							<i class="glyphicon glyphicon-refresh"></i>
			    			<span class="hidden-xs">refresh world</span>
			    		</button>
			    	</span>
				</h3>
				<div class="bg-silver" data-ng-view="worldView" id="game">
					<div>
						World : {{world}}
					</div>
				</div>
			</div>
		</div>
	</div>

	<script type="text/javascript" src="js/jquery-1.11.3.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/angular.min.js"></script>
	
	<script>
		var app = angular.module( 'worldModule', [] )
		
		app.controller('worldController', function( $scope, $interval, httpService ) {
			
			$scope.updateWorld = function() {
				httpService.getData("/world/get").then(function(data){
					$scope.world = data
				})
			}
			
			angular.element(document).ready(function () {
				$scope.updateWorld()

				//update view with 5s interval
				$interval(function(){
					$scope.updateWorld()
				}, 5000);
		    });
		})
	</script>
	<script type="text/javascript" src="js/shelter/http-service.js"></script>
</body>
</html>
